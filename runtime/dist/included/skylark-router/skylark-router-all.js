/**
 * skylark-router - An Elegant HTML5 Routing Framework.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.6-beta
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,n){function r(t,n){if("."!==t[0])return t;var r=n.split("/"),e=t.split("/");r.pop();for(var i=0;i<e.length;i++)"."!=e[i]&&(".."==e[i]?r.pop():r.push(e[i]));return r.join("/")}var e=n.define,i=n.require,o="function"==typeof e&&e.amd,u=!o&&"undefined"!=typeof exports;if(!o&&!e){var a={};e=n.define=function(t,n,e){"function"==typeof e?(a[t]={factory:e,deps:n.map(function(n){return r(n,t)}),exports:null},i(t)):resolved[t]=e},i=n.require=function(t){if(!a.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var n=a[t];if(!n.exports){var r=[];n.deps.forEach(function(t){r.push(i(t))}),n.exports=n.factory.apply(window,r)}return n.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");t(e,i),o||(u?exports=i("skylark-router/router"):n.skylarkjs=i("skylark-router/main"))}(function(t,n){t("skylark-langx/skylark",[],function(){var t={};return t}),t("skylark-langx/langx",["./skylark"],function(t){function n(t,n,r,e){var i,o=t[n],u="around"==n;if(u){var a=r(function(){return o.advice(this,arguments)});i={remove:function(){a&&(a=t=r=null)},advice:function(t,n){return a?a.apply(t,n):o.advice(t,n)}}}else i={remove:function(){if(i.advice){var e=i.previous,o=i.next;o||e?(e?e.next=o:t[n]=o,o&&(o.previous=e)):delete t[n],t=r=i.advice=null}},id:G++,advice:r,receiveArguments:e};if(o&&!u)if("after"==n){for(;o.next&&(o=o.next););o.next=i,i.previous=o}else"before"==n&&(t[n]=i,i.next=o,o.previous=i);else t[n]=i;return i}function r(t){return function(r,e,i,o){var u,a=r[e];a&&a.target==r||(r[e]=u=function(){for(var t=G,n=arguments,r=u.before;r;)n=r.advice.apply(this,n)||n,r=r.next;if(u.around)var e=u.around.advice(this,n);for(var i=u.after;i&&i.id<t;){if(i.receiveArguments){var o=i.advice.apply(this,n);e=o===J?e:o}else e=i.advice.call(this,e,n);i=i.next}return e},a&&(u.around={advice:function(t,n){return a.apply(t,n)}}),u.target=r);var s=n(u||a,t,i,o);return i=null,s}}function e(t,n){var r;if(t===J||null===t)r=t;else if(n&&t.clone)r=t.clone();else if(v(t)){r=[];for(var i=0;i<t.length;i++)r.push(e(t[i]))}else if(x(t)){r={};for(var o in t)r[o]=e(t[o])}else r=t;return r}function i(t,n){var r=new CustomEvent(t,n);return q(r,n)}function o(t,n){var r,e,i=function(){t.apply(null,e)};return function(){e=arguments,clearTimeout(r),r=setTimeout(i,n)}}function u(t){return Q.call(t,function(t){return null!=t})}function a(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function s(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?JSON.parse(t):t):t}catch(n){return t}}function c(t,n){var r,e,i,o,u;if(t)if(r=t.length,r===o){for(e in t)if(t.hasOwnProperty(e)&&(u=t[e],n.call(u,e,u)===!1))break}else for(i=0;i<r&&(u=t[i],n.call(u,i,u)!==!1);i++);return this}function f(t){if(d(t)){for(var n=[],r=0;r<t.length;r++){var e=t[r];if(d(e))for(var i=0;i<e.length;i++)n.push(e[i]);else n.push(e)}return n}return t}function l(t,n,r,e){return m(n)?n.call(t,r,e):n}function h(t){var t=t||window.location.href,n=t.split("?"),r={};return n.length>1&&n[1].split("&").forEach(function(t){var n=t.split("=");r[n[0]]=n[1]}),r}function p(t,n){if(!n)return-1;var r;if(n.indexOf)return n.indexOf(t);for(r=n.length;r--;)if(n[r]===t)return r;return-1}function v(t){return t&&t.constructor===Array}function d(t){return!_(t)&&!A(t)&&"number"==typeof t.length}function g(t){return"boolean"==typeof t}function y(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function b(t,n){return tt(t,n)}function m(t){return"function"==it(t)}function w(t){return"object"==it(t)}function x(t){return w(t)&&!k(t)&&Object.getPrototypeOf(t)==Object.prototype}function _(t){return"string"==typeof t}function k(t){return t&&t==t.window}function j(t){return"undefined"!=typeof t}function A(t){return t&&t instanceof Node}function E(t){return"number"==typeof t}function O(t){if(t){var n=location.protocol+"//"+location.hostname;return location.port&&(n+=":"+location.port),t.startsWith(n)}}function S(t){var n;for(n in t)if(null!==t[n])return!1;return!0}function T(t,n,r){return d(t)?(r||[]).concat(Array.prototype.slice.call(t,n||0)):[t]}function D(t,n){var r,e,i,o=[];if(d(t))for(e=0;e<t.length;e++)r=n.call(t[e],t[e],e),null!=r&&o.push(r);else for(i in t)r=n.call(t[i],t[i],i),null!=r&&o.push(r);return f(o)}function N(t){return requestAnimationFrame(t),this}function C(t,n){var r=2 in arguments&&W.call(arguments,2);if(m(t)){var e=function(){return t.apply(n,r?r.concat(W.call(arguments)):arguments)};return e}if(_(n))return r?(r.unshift(t[n],t),C.apply(null,r)):C(t[n],t);throw new TypeError("expected function")}function P(t){return parseFloat(t)||0}function H(t){return null==t?"":String.prototype.trim.call(t)}function R(t,n){if(v(t)){var r=t.indexOf(n);r!=-1&&t.splice(r,1)}else if(x(t))for(var e in t)if(t[e]==n){delete t[e];break}return this}function z(t,n,r,e){for(var i in n)n.hasOwnProperty(i)&&(e&&t[i]!==J||(r&&(x(n[i])||v(n[i]))?(x(n[i])&&!x(t[i])&&(t[i]={}),v(n[i])&&!v(t[i])&&(t[i]=[]),z(t[i],n[i],r,e)):n[i]!==J&&(t[i]=n[i])));return t}function F(t){var n=W.call(arguments,0);return target=n.shift(),deep=!1,g(n[n.length-1])&&(deep=n.pop()),{target:target,sources:n,deep:deep}}function L(){var t=F.apply(this,arguments);return t.sources.forEach(function(n){z(t.target,n,t.deep,!1)}),t.target}function U(t,n,r){v(n)||(n=[n]);var e=n.length;if(!e)return m(r)?r.call(t):r;for(var i=0;i<e;i++){var o=null==t?void 0:t[n[i]];void 0===o&&(o=r,i=e),t=m(o)?o.call(t):o}return t}function q(){var t=F.apply(this,arguments);return t.sources.forEach(function(n){z(t.target,n,t.deep,!0)}),t.target}function $(t,n,r,e){function i(t,n){if(t.match(/\./)){var r,e=function(t,n){var i=t.pop();return i?n[i]?e(t,r=n[i]):null:r};return e(t.split(".").reverse(),n)}return n[t]}return e=e||window,r=r?C(e,r):function(t){return t},t.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(t,o,u){var a=i(o,n);return u&&(a=i(u,e).call(e,a,o)),r(a,o).toString()})}function M(t){return t._uid||(t._uid=ut++)}function Z(t){return Q.call(t,function(n,r){return t.indexOf(n)==r})}function I(t){var n=++at+"";return t?t+n:n}function B(){return B}var J,V={}.toString,W=(Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice),Q=Array.prototype.filter,G=0,K=function(){function t(t,n,r){var e=t.prototype,i=t.superclass.prototype,o=r&&r.noOverrided;for(var u in n)"constructor"!==u&&(e[u]="function"!=typeof n[u]||n[u]._constructor||o||"function"!=typeof i[u]?n[u]:function(t,n,r){return function(){var t=this.overrided;this.overrided=r;var e=n.apply(this,arguments);return this.overrided=t,e}}(u,n[u],i[u]));return t}return function n(r,e,i){var o=r.constructor;o===Object&&(o=function(){this.init&&this.init.apply(this,arguments)});var u=r.klassName||"",a=new Function("return function "+u+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}ctor._constructor.apply(inst, arguments);return inst;}")();return a._constructor=o,e=e||Object,a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.superclass=e,a.__proto__=e,a.partial||(a.partial=function(n,r){return t(this,n,r)}),a.inherit||(a.inherit=function(t,r){return n(t,this,r)}),a.partial(r,i),a}}(),X=function(){function t(){}return function(n,r){t.prototype=n;var e=new t;return t.prototype=null,r&&L(e,r),e}}(),Y=function(){this.promise=new Promise(function(t,n){this._resolve=t,this._reject=n}.bind(this)),this.resolve=Y.prototype.resolve.bind(this),this.reject=Y.prototype.reject.bind(this)};Y.prototype.resolve=function(t){return this._resolve.call(this.promise,t),this},Y.prototype.reject=function(t){return this._reject.call(this.promise,t),this},Y.prototype.then=function(t,n,r){return this.promise.then(t,n,r)},Y.all=function(t){return Promise.all(t)},Y.first=function(t){return Promise.race(t)},Y.when=function(t,n,r,e){var i=t&&"function"==typeof t.then,o=i&&t instanceof Promise;if(!i)return arguments.length>1?n?n(t):t:(new Y).resolve(t);if(!o){var u=new Y(t.cancel);t.then(u.resolve,u.reject,u.progress),t=u.promise}return n||r||e?t.then(n,r,e):t},Y.reject=function(t){var n=new Y;return n.reject(t),n.promise},Y.resolve=function(t){var n=new Y;return n.resolve(t),n.promise},Y.immediate=Y.resolve;var tt,nt,rt=K({on:function(t,n,r,e,i,o){var u=this,a=this._hub||(this._hub={});return x(t)?(i=e,c(t,function(t,e){u.on(t,n,r,e,i,o)}),this):(_(n)||m(e)||(i=e,e=r,r=n,n=J),m(r)&&(i=e,e=r,r=null),_(t)&&(t=t.split(/\s/)),t.forEach(function(t){(a[t]||(a[t]=[])).push({fn:e,selector:n,data:r,ctx:i,one:o})}),this)},one:function(t,n,r,e,i){return this.on(t,n,r,e,i,1)},trigger:function(t){if(!this._hub)return this;var n=this;_(t)&&(t=new CustomEvent(t)),t.target=this;var r=W.call(arguments,1);return r=j(r)?[t].concat(r):[t],[t.type||t.name,"all"].forEach(function(e){var i=n._hub[e];if(i){for(var o=i.length,a=!1,s=0;s<o;s++){var c=i[s];t.data?c.data&&(t.data=L({},c.data,t.data)):t.data=c.data||null,c.fn.apply(c.ctx,r),c.one&&(i[s]=null,a=!0)}a&&(n._hub[e]=u(i))}}),this},listened:function(t){var n=(this._hub||(this._events={}))[t]||[];return n.length>0},listenTo:function(t,n,r,e){if(!t)return this;_(r)&&(r=this[r]),e?t.one(n,r,this):t.on(n,r,this);for(var i,o=this._listeningTo||(this._listeningTo=[]),u=0;u<o.length;u++)if(o[u].obj==t){i=o[u];break}i||o.push(i={obj:t,events:{}});var a=i.events,s=a[n]=a[n]||[];return s.indexOf(r)==-1&&s.push(r),this},listenToOnce:function(t,n,r){return this.listenTo(t,n,r,1)},off:function(t,n){var r=this._hub||(this._hub={});return _(t)&&(t=t.split(/\s/)),t.forEach(function(t){var e=r[t],i=[];if(e&&n)for(var o=0,u=e.length;o<u;o++)e[o].fn!==n&&e[o].fn._!==n&&i.push(e[o]);i.length?r[t]=i:delete r[t]}),this},unlistenTo:function(t,n,r){var e=this._listeningTo;if(!e)return this;for(var i=0;i<e.length;i++){var o=e[i];if(!t||t==o.obj){var a=o.events;for(var s in a)if(!n||n==s){listeningEvent=a[s];for(var c=0;c<listeningEvent.length;c++)r&&r!=listeningEvent[i]||(o.obj.off(s,listeningEvent[i],this),listeningEvent[i]=null);listeningEvent=a[s]=u(listeningEvent),S(listeningEvent)&&(a[s]=null)}S(a)&&(e[i]=null)}}return e=this._listeningTo=u(e),S(e)&&(this._listeningTo=null),this}}),et=(function(){var t;return function(n){return t||(t=document.createElement("a")),t.href=n,t.href}}(),"undefined"!=typeof Symbol?Symbol.prototype:null);tt=function(t,n,r,e){if(t===n)return 0!==t||1/t===1/n;if(null==t||null==n)return!1;if(t!==t)return n!==n;var i=typeof t;return("function"===i||"object"===i||"object"==typeof n)&&nt(t,n,r,e)},nt=function(t,n,r,e){var i=V.call(t);if(i!==V.call(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!==+t?+n!==+n:0===+t?1/+t===1/n:+t===+n;case"[object Date]":case"[object Boolean]":return+t===+n;case"[object Symbol]":return et.valueOf.call(t)===et.valueOf.call(n)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof n)return!1;var u=t.constructor,a=n.constructor;if(u!==a&&!(m(u)&&u instanceof u&&m(a)&&a instanceof a)&&"constructor"in t&&"constructor"in n)return!1}r=r||[],e=e||[];for(var s=r.length;s--;)if(r[s]===t)return e[s]===n;if(r.push(t),e.push(n),o){if(s=t.length,s!==n.length)return!1;for(;s--;)if(!tt(t[s],n[s],r,e))return!1}else{var c,f=Object.keys(t);if(s=f.length,Object.keys(n).length!==s)return!1;for(;s--;)if(c=f[s],n[c]===J||!tt(t[c],n[c],r,e))return!1}return r.pop(),e.pop(),!0};var it=function(){var t={};return c("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(n,r){t["[object "+r+"]"]=r.toLowerCase()}),function(n){return null==n?String(n):t[V.call(n)]||"object"}}(),ot=rt.inherit({init:function(t,n){var r=t||{};n||(n={}),this.cid=I(this.cidPrefix),this.attributes={},n.collection&&(this.collection=n.collection),n.parse&&(r=this.parse(r,n)||{});var e=U(this,"defaults");r=L({},e,r),this.set(r,n),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return e(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,n,r){if(null==t)return this;var i;if("object"==typeof t?(i=t,r=n):(i={})[t]=n,r||(r={}),!this._validate(i,r))return!1;var o=r.unset,u=r.silent,a=[],s=this._changing;this._changing=!0,s||(this._previousAttributes=e(this.attributes),this.changed={});var c=this.attributes,f=this.changed,l=this._previousAttributes;for(var h in i)n=i[h],b(c[h],n)||a.push(h),b(l[h],n)?delete f[h]:f[h]=n,o?delete c[h]:c[h]=n;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!u){a.length&&(this._pending=r);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],r)}if(s)return this;if(!u)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,n){return this.set(t,void 0,L({},n,{unset:!0}))},clear:function(t){var n={};for(var r in this.attributes)n[r]=void 0;return this.set(n,L({},t,{unset:!0}))},hasChanged:function(t){return null==t?!S(this.changed):this.changed[t]!==J},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&e(this.changed);var n=this._changing?this._previousAttributes:this.attributes,r={};for(var i in t){var o=t[i];b(n[i],o)||(r[i]=o)}return!S(r)&&r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return e(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},L({},t,{validate:!0}))},_validate:function(t,n){if(!n.validate||!this.validate)return!0;t=L({},this.attributes,t);var r=this.validationError=this.validate(t,n)||null;return!r||(this.trigger("invalid",this,r,L(n,{validationError:r})),!1)}}),ut=1,at=0;return L(B,{after:r("after"),around:r("around"),before:r("before"),camelCase:function(t){return t.replace(/-([\da-z])/g,function(t){return t.toUpperCase().replace("-","")})},clone:e,compact:u,createEvent:i,dasherize:a,debounce:o,delegate:X,Deferred:Y,Evented:rt,deserializeValue:s,each:c,flatten:f,funcArg:l,getQueryParams:h,inArray:p,isArray:v,isArrayLike:d,isBoolean:g,isDefined:function(t){return t!==J},isDocument:y,isEmptyObject:S,isEqual:b,isFunction:m,isHtmlNode:A,isObject:w,isPlainObject:x,isNumber:E,isString:_,isSameOrigin:O,isWindow:k,klass:function(t,n,r){return K(t,n,r)},lowerFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},makeArray:T,map:D,mixin:L,nextTick:N,proxy:C,removeItem:R,result:U,returnTrue:function(){return!0},returnFalse:function(){return!1},safeMixin:q,serializeValue:function(t){return JSON.stringify(t)},Stateful:ot,substitute:$,toPixel:P,trim:H,type:it,uid:M,uniq:Z,uniqueId:I,upperFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},URL:window.URL||window.webkitURL}),t.langx=B}),t("skylark-router/router",["skylark-langx/skylark","skylark-langx/langx"],function(t,n){function r(t,r){var e=new CustomEvent(t,r);return n.safeMixin(e,r)}function e(){return d}function i(t){if(d){var e=d.route.exit({path:d.path,params:d.params},!0);if(!e)return}if(g=d,d=t,!d.route){var i=u(d.path);d.route=i.route,d.params=i.params}var o=d.route.enter({force:d.force,path:d.path,params:d.params},!0);n.Deferred.when(o).then(function(){x.trigger(r("routing",{current:d,previous:g})),d.route.enter({path:d.path,params:d.params},!1),g&&g.route.exit({path:g.path,params:g.params},!1),x.trigger(r("routed",{current:d,previous:g}))})}function o(t,n){if(!n&&d&&d.path==t)return!1;var e=u(t);if(e)if(e.path=t,k.useHistoryApi){var o={force:n,path:t};window.history.pushState(o,document.title,(y+t).replace("//","/")),window.dispatchEvent(r("popstate",{state:o}))}else if(k.useHashbang){var a="#!"+t;window.location.hash!==a?window.location.hash=a:i(e)}else i(e);return!0}function u(t,r){var e=!1;return!r&&(e=w[t])?e:(n.each(m,function(n,r){var i=r.match(t);return!i||(e={route:r,params:i},!1)}),e&&!r&&(w[t]=e),e)}function a(t,n){var r,e=m[t];return e&&(r=e.path(n)),r}function s(){return g}function c(t){return n.isDefined(t)?(y=t,this):y}function f(){return x}function l(t){return n.isDefined(t)?(b=t,this):b}function h(t,r){if(n.isDefined(r)){var e={};return e[t]=r,p(e),this}return m[t]}function p(t){if(!n.isDefined(t))return n.mixin({},m);for(var r in t)m[r]=new k.Route(r,t[r])}function v(){null==k.useHashbang&&null==k.useHistoryApi&&(window.location.host&&window.history.pushState?k.useHistoryApi=!0:k.useHashbang=!0);var t="";k.useHistoryApi?(t=window.location.pathname,void 0===y&&(y=t.replace(/\/$/,"")),t=t.replace(y,"")||b||"/"):t=k.useHashbang?window.location.hash.replace("#!","")||b||"/":"/",t.startsWith("/")||(t="/"+t),k.useHistoryApi?window.addEventListener("popstate",function(t){t.state&&i(t.state),t.preventDefault()}):k.useHashbang&&window.addEventListener("hashchange",function(t){i({path:window.location.hash.replace(/^#!/,"")}),t.preventDefault()}),o(t)}var d,g,y,b,m={},w={},x=new n.Evented,_=n.Evented.inherit({klassName:"Route",init:function(t,r){r=n.mixin({},r);var e=r.pathto||"",i=e,o=i.match(/\:([a-zA-Z0-9_]+)/g);null!==o?(o=o.map(function(t){return t.substring(1)}),i=i.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")):o=[],i="*"===i?"(.*)":i.replace("/","\\/"),this._setting=r,this.name=t,this.pathto=e,this.paramNames=o,this.params=i,this.regex=new RegExp("^"+i+"$","");var u=this;["entering","entered","exiting","exited"].forEach(function(t){n.isFunction(r[t])&&u.on(t,r[t])})},enter:function(t,e){if(e){var i=this._entering(t),o=this;return n.Deferred.when(i).then(function(){var t=r("entering",{route:o,result:!0});return o.trigger(t),t.result})}return this._entered(t),this.trigger(r("entered",n.safeMixin({route:this},t))),this},exit:function(t,e){if(e){var i=this._exiting(t);if(!i)return!1;var o=r("exiting",{route:this,result:!0});return this.trigger(o),o.result}return this._exited(t),this.trigger(r("exited",n.safeMixin({route:this},t))),this},match:function(t){var n=this.paramNames,r=t.indexOf("?"),t=~r?t.slice(0,r):decodeURIComponent(t),e=this.regex.exec(t);if(!e)return!1;for(var i={},o=1,u=e.length;o<u;++o){var a=n[o-1],s=decodeURIComponent(e[o]);i[a]=s}return i},path:function(t){var n=this.pathto;return t&&(n=n.replace(/:([a-zA-Z0-9_]+)/g,function(n,r){return t[r]})),n},_entering:function(t){return!0},_entered:function(t){return!0},_exiting:function(t){return!0},_exited:function(t){return!0}}),k=function(){return k};return n.mixin(k,{Route:_,current:e,go:o,map:u,hub:f,off:function(){x.off.apply(x,arguments)},on:function(){x.on.apply(x,arguments)},one:function(){x.one.apply(x,arguments)},path:a,previous:s,baseUrl:c,homePath:l,route:h,routes:p,start:v,trigger:function(t){return x.trigger(t),this},useHistoryApi:null,useHashbang:null}),t.router=k}),t("skylark-router/main",["skylark-langx/skylark","./router"],function(t){return t}),t("skylark-router",["skylark-router/main"],function(t){return t})},this);
//# sourceMappingURL=sourcemaps/skylark-router-all.js.map
