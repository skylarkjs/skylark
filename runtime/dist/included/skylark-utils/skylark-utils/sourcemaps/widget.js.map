{"version":3,"sources":["widget.js"],"names":["define","skylark","langx","noder","styler","geom","eventer","query","widget","delegateEventSplitter","Widget","Evented","inherit","init","el","options","isHtmlNode","this","mixin","cid","uniqueId","_ensureElement","tagName","$","selector","$el","find","render","remove","_removeElement","unlistenTo","setElement","element","undelegateEvents","_setElement","delegateEvents","events","result","key","method","isFunction","match","delegate","proxy","eventName","listener","on","uid","off","undelegate","_createElement","attrs","createElement","id","className","_setAttributes","attributes","attr"],"mappings":";;;;;;;AAAAA,QACI,YACA,UACA,UACA,WACA,SACA,YACA,WACD,SAASC,EAAQC,EAAMC,EAAMC,EAAOC,EAAKC,EAAQC,GAIhD,QAASC,KACL,MAAOA,GAHb,GAAIC,GAAwB,iBAMzBC,EAASR,EAAMS,QAAQC,SACpBC,KAAM,SAASC,EAAGC,GACTb,EAAMc,WAAWF,KAClBC,EAAUD,EACVA,EAAK,MAETG,KAAKH,GAAKA,EACNC,GACAb,EAAMgB,MAAMD,KAAKF,GAEhBE,KAAKE,MACNF,KAAKE,IAAMjB,EAAMkB,SAAS,MAE9BH,KAAKI,kBAIZC,QAAS,MAITC,EAAG,SAASC,GACV,MAAOP,MAAKQ,IAAIC,KAAKF,IAMvBG,OAAQ,WACN,MAAOV,OAKTW,OAAQ,WAGN,MAFAX,MAAKY,iBACLZ,KAAKa,aACEb,MAMTY,eAAgB,WACdZ,KAAKQ,IAAIG,UAKXG,WAAY,SAASC,GAInB,MAHAf,MAAKgB,mBACLhB,KAAKiB,YAAYF,GACjBf,KAAKkB,iBACElB,MAQTiB,YAAa,SAASpB,GACpBG,KAAKQ,IAAMjB,EAAOe,EAAET,GACpBG,KAAKH,GAAKG,KAAKQ,IAAI,IAgBrBU,eAAgB,SAASC,GAEvB,GADAA,IAAWA,EAASlC,EAAMmC,OAAOpB,KAAM,YAClCmB,EAAQ,MAAOnB,KACpBA,MAAKgB,kBACL,KAAK,GAAIK,KAAOF,GAAQ,CACtB,GAAIG,GAASH,EAAOE,EAEpB,IADKpC,EAAMsC,WAAWD,KAASA,EAAStB,KAAKsB,IACxCA,EAAL,CACA,GAAIE,GAAQH,EAAIG,MAAMhC,EACtBQ,MAAKyB,SAASD,EAAM,GAAIA,EAAM,GAAIvC,EAAMyC,MAAMJ,EAAQtB,QAExD,MAAOA,OAMTyB,SAAU,SAASE,EAAWpB,EAAUqB,GAEtC,MADA5B,MAAKQ,IAAIqB,GAAGF,EAAY,kBAAoB3B,KAAK8B,IAAKvB,EAAUqB,GACzD5B,MAMTgB,iBAAkB,WAEhB,MADIhB,MAAKQ,KAAKR,KAAKQ,IAAIuB,IAAI,kBAAoB/B,KAAK8B,KAC7C9B,MAKTgC,WAAY,SAASL,EAAWpB,EAAUqB,GAExC,MADA5B,MAAKQ,IAAIuB,IAAIJ,EAAY,kBAAoB3B,KAAK8B,IAAKvB,EAAUqB,GAC1D5B,MAKTiC,eAAgB,SAAS5B,EAAQ6B,GAC/B,MAAOhD,GAAMiD,cAAc9B,EAAQ6B,IAOrC9B,eAAgB,WACd,GAAKJ,KAAKH,GAORG,KAAKc,WAAW7B,EAAMmC,OAAOpB,KAAM,WAPvB,CACZ,GAAIkC,GAAQjD,EAAMgB,SAAUhB,EAAMmC,OAAOpB,KAAM,cAC3CA,MAAKoC,KAAIF,EAAME,GAAKnD,EAAMmC,OAAOpB,KAAM,OACvCA,KAAKqC,YAAWH,EAAM,SAAWjD,EAAMmC,OAAOpB,KAAM,cACxDA,KAAKc,WAAWd,KAAKiC,eAAehD,EAAMmC,OAAOpB,KAAM,WAAWkC,IAClElC,KAAKsC,eAAeJ,KAQxBI,eAAgB,SAASC,GACvBvC,KAAKQ,IAAIgC,KAAKD,KAYjB,OAPAtD,GAAMgB,MAAMV,GACXe,EAAIhB,EAEJG,OAASA,IAIHT,EAAQO,OAASA","file":"../widget.js","sourcesContent":["define([\r\n    \"./skylark\",\r\n    \"./langx\",\r\n    \"./noder\",\r\n    \"./styler\",\r\n    \"./geom\",\r\n    \"./eventer\",\r\n    \"./query\"\r\n], function(skylark,langx,noder,styler,geom,eventer,query) {\r\n  // Cached regex to split keys for `delegate`.\r\n  var delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\r\n\r\n    function widget() {\r\n        return widget;\r\n    }\r\n\r\n\tvar Widget = langx.Evented.inherit({\r\n        init :function(el,options) {\r\n            if (!langx.isHtmlNode(el)) {\r\n                options = el;\r\n                el = null;\r\n            }\r\n            this.el = el;\r\n            if (options) {\r\n                langx.mixin(this,options);\r\n            }\r\n            if (!this.cid) {\r\n                this.cid = langx.uniqueId('w');\r\n            }\r\n            this._ensureElement();\r\n        },\r\n\r\n\t    // The default `tagName` of a View's element is `\"div\"`.\r\n\t    tagName: 'div',\r\n\r\n\t    // jQuery delegate for element lookup, scoped to DOM elements within the\r\n\t    // current view. This should be preferred to global lookups where possible.\r\n\t    $: function(selector) {\r\n\t      return this.$el.find(selector);\r\n\t    },\r\n\r\n\t    // **render** is the core function that your view should override, in order\r\n\t    // to populate its element (`this.el`), with the appropriate HTML. The\r\n\t    // convention is for **render** to always return `this`.\r\n\t    render: function() {\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Remove this view by taking the element out of the DOM, and removing any\r\n\t    // applicable Backbone.Events listeners.\r\n\t    remove: function() {\r\n\t      this._removeElement();\r\n\t      this.unlistenTo();\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Remove this view's element from the document and all event listeners\r\n\t    // attached to it. Exposed for subclasses using an alternative DOM\r\n\t    // manipulation API.\r\n\t    _removeElement: function() {\r\n\t      this.$el.remove();\r\n\t    },\r\n\r\n\t    // Change the view's element (`this.el` property) and re-delegate the\r\n\t    // view's events on the new element.\r\n\t    setElement: function(element) {\r\n\t      this.undelegateEvents();\r\n\t      this._setElement(element);\r\n\t      this.delegateEvents();\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Creates the `this.el` and `this.$el` references for this view using the\r\n\t    // given `el`. `el` can be a CSS selector or an HTML string, a jQuery\r\n\t    // context or an element. Subclasses can override this to utilize an\r\n\t    // alternative DOM manipulation API and are only required to set the\r\n\t    // `this.el` property.\r\n\t    _setElement: function(el) {\r\n\t      this.$el = widget.$(el);\r\n\t      this.el = this.$el[0];\r\n\t    },\r\n\r\n\t    // Set callbacks, where `this.events` is a hash of\r\n\t    //\r\n\t    // *{\"event selector\": \"callback\"}*\r\n\t    //\r\n\t    //     {\r\n\t    //       'mousedown .title':  'edit',\r\n\t    //       'click .button':     'save',\r\n\t    //       'click .open':       function(e) { ... }\r\n\t    //     }\r\n\t    //\r\n\t    // pairs. Callbacks will be bound to the view, with `this` set properly.\r\n\t    // Uses event delegation for efficiency.\r\n\t    // Omitting the selector binds the event to `this.el`.\r\n\t    delegateEvents: function(events) {\r\n\t      events || (events = langx.result(this, 'events'));\r\n\t      if (!events) return this;\r\n\t      this.undelegateEvents();\r\n\t      for (var key in events) {\r\n\t        var method = events[key];\r\n\t        if (!langx.isFunction(method)) method = this[method];\r\n\t        if (!method) continue;\r\n\t        var match = key.match(delegateEventSplitter);\r\n\t        this.delegate(match[1], match[2], langx.proxy(method, this));\r\n\t      }\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Add a single event listener to the view's element (or a child element\r\n\t    // using `selector`). This only works for delegate-able events: not `focus`,\r\n\t    // `blur`, and not `change`, `submit`, and `reset` in Internet Explorer.\r\n\t    delegate: function(eventName, selector, listener) {\r\n\t      this.$el.on(eventName + '.delegateEvents' + this.uid, selector, listener);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Clears all callbacks previously bound to the view by `delegateEvents`.\r\n\t    // You usually don't need to use this, but may wish to if you have multiple\r\n\t    // Backbone views attached to the same DOM element.\r\n\t    undelegateEvents: function() {\r\n\t      if (this.$el) this.$el.off('.delegateEvents' + this.uid);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // A finer-grained `undelegateEvents` for removing a single delegated event.\r\n\t    // `selector` and `listener` are both optional.\r\n\t    undelegate: function(eventName, selector, listener) {\r\n\t      this.$el.off(eventName + '.delegateEvents' + this.uid, selector, listener);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Produces a DOM element to be assigned to your view. Exposed for\r\n\t    // subclasses using an alternative DOM manipulation API.\r\n\t    _createElement: function(tagName,attrs) {\r\n\t      return noder.createElement(tagName,attrs);\r\n\t    },\r\n\r\n\t    // Ensure that the View has a DOM element to render into.\r\n\t    // If `this.el` is a string, pass it through `$()`, take the first\r\n\t    // matching element, and re-assign it to `el`. Otherwise, create\r\n\t    // an element from the `id`, `className` and `tagName` properties.\r\n\t    _ensureElement: function() {\r\n\t      if (!this.el) {\r\n\t        var attrs = langx.mixin({}, langx.result(this, 'attributes'));\r\n\t        if (this.id) attrs.id = langx.result(this, 'id');\r\n\t        if (this.className) attrs['class'] = langx.result(this, 'className');\r\n\t        this.setElement(this._createElement(langx.result(this, 'tagName'),attrs));\r\n\t        this._setAttributes(attrs);\r\n\t      } else {\r\n\t        this.setElement(langx.result(this, 'el'));\r\n\t      }\r\n\t    },\r\n\r\n\t    // Set attributes from a hash on this view's element.  Exposed for\r\n\t    // subclasses using an alternative DOM manipulation API.\r\n\t    _setAttributes: function(attributes) {\r\n\t      this.$el.attr(attributes);\r\n\t    }\r\n  \t});\r\n\r\n\r\n    langx.mixin(widget, {\r\n    \t$ : query,\r\n\r\n    \tWidget : Widget\r\n    });\r\n\r\n\r\n    return skylark.widget = widget;\r\n});\r\n"]}