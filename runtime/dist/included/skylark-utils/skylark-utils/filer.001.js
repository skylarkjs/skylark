/**
 * skylark-utils - An Elegant HTML5 JavaScript Library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5-beta
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./skylark","./langx","./datax","./eventer","./styler"],function(e,t,r,n,a){function i(e,r){r=r||{};var i=r.hoverClass||"dropzone",o=r.dropped,s=0;return u(e,"dragenter",function(t){t.dataTransfer&&t.dataTransfer.types.indexOf("Files")>-1&&(n.stop(t),s++,a.addClass(e,i))}),u(e,"dragover",function(e){e.dataTransfer&&e.dataTransfer.types.indexOf("Files")>-1&&n.stop(e)}),u(e,"dragleave",function(t){t.dataTransfer&&t.dataTransfer.types.indexOf("Files")>-1&&(s--,0==s&&a.removeClass(e,i))}),u(e,"drop",function(r){if(r.dataTransfer&&r.dataTransfer.types.indexOf("Files")>-1&&(a.removeClass(e,i),n.stop(r),o)){var s=r.dataTransfer.items;s&&s.length&&(s[0].webkitGetAsEntry||s[0].getAsEntry)?v.all(t.map(s,function(e){return e.webkitGetAsEntry?e.webkitGetAsEntry():e.getAsEntry()})).then(o):o(r.dataTransfer.files)}}),this}function o(e,r){r=r||{};var n=(r.hoverClass||"pastezone",r.pasted);return u(e,"paste",function(e){var r=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,a=[];r&&r.length&&t.each(r,function(e,t){var r=t.getAsFile&&t.getAsFile();r&&a.push(r)}),n&&a.length&&n(a)}),this}function s(e,t){return u(e,"click",function(e){e.preventDefault(),l(t)}),this}function l(e){function t(e){for(var t=e.length;t--;)e[t].size>p&&e.splice(t,1);n(e)}e=e||{};var r=e.multiple||!1,n=e.picked;if(!f){var a=f=document.createElement("input");a.type="file",a.style.position="fixed",a.style.left=0,a.style.top=0,a.style.opacity=.001,document.body.appendChild(a),a.onchange=function(e){var r=e.target.webkitEntries||e.target.entries;r&&r.length?v.all(r).then(function(e){t(e)}):t(Array.prototype.slice.call(e.target.files)),a.value=""}}f.multiple=r,f.webkitdirectory=directory,f.click()}var f,c=Array.prototype.concat,u=n.on,d=(n.attr,t.Deferred),p=1/0,v=function(){function e(e,t){var n=new d,a=function(e){n.reject(e)};if(t=t||"",e.isFile)e.file(function(e){e.relativePath=t,n.resolve(e)},a);else if(e.isDirectory){var i=e.createReader();i.readEntries(function(i){r(i,t+e.name+"/").then(function(e){n.resolve(e)})["catch"](a)},a)}else n.resolve([]);return n.promise}function r(r,n){return d.all(t.map(r,function(t){return e(t,n)})).then(function(){return c.apply([],arguments)})}return{one:e,all:r}}(),y=(t.Evented.inherit({init:function(e){}}),function(){return y});return t.mixin(y,{dropzone:i,pastezone:o,picker:s,select:l,upload:function(){},readFile:function(e,t){t=t||{};var r=new d,n=new FileReader;return n.onload=function(e){r.resolve(e.target.result)},n.onerror=function(e){var t=e.target.error.code;2===t?alert("please don't open this page using protocol fill:///"):alert("error code: "+t)},t.asArrayBuffer?n.readAsArrayBuffer(e):t.asDataUrl?n.readAsDataURL(e):t.asText?n.readAsText(e):n.readAsArrayBuffer(e),r.promise},writeFile:function(e,r){if(window.navigator.msSaveBlob)t.isString(e)&&(e=dataURItoBlob(e)),window.navigator.msSaveBlob(e,r);else{var n=document.createElement("a");e instanceof Blob&&(e=t.URL.createObjectURL(e)),n.href=e,n.setAttribute("download",r||"noname"),n.dispatchEvent(new CustomEvent("click"))}}}),e.filer=y});
//# sourceMappingURL=sourcemaps/filer.001.js.map
