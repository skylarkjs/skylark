{"version":3,"sources":["eventer.js"],"names":["define","skylark","langx","browser","finder","noder","datax","compatible","event","source","isDefaultPrevented","each","eventMethods","name","predicate","sourceMethod","this","returnTrue","apply","arguments","returnFalse","parse","segs","split","type","ns","slice","sort","join","createProxy","key","proxy","originalEvent","ignoreProperties","test","undefined","off","elm","events","selector","callback","$this","isPlainObject","fn","isString","isFunction","indexOf","handler","findHandler","forEach","unregister","on","data","one","ready","register","stop","window","document","all","keyCode","preventDefault","stopPropagation","trigger","evented","args","e","Event","createEvent","_args","dispatchEvent","call","readyRE","readyState","body","addEventListener","shortcuts","registry","run","shortcut","n","metaKey","ctrlKey","ctrl","alt","altKey","shift","shiftKey","charCode","target","nodeName","add","pattern","shortcutKeys","toLowerCase","shortcutKey","setting","charCodeAt","keyCodeLookup","toUpperCase","regKey","eventer","uid","mixin","Array","prototype","stopImmediatePropagation","getEventCtor","idx","NativeEvents","EventCtors","compositionstart","compositionend","compositionupdate","beforecopy","beforecut","beforepaste","copy","cut","paste","drag","dragend","dragenter","dragexit","dragleave","dragover","dragstart","drop","abort","change","error","selectionchange","submit","reset","focus","blur","focusin","focusout","keydown","keypress","keyup","message","click","contextmenu","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","textInput","touchstart","touchmove","touchend","load","resize","select","scroll","unload","wheel","props","parsed","bubbles","cancelable","namespace","ctor","safeMixin","specialEvents","focusinSupported","hover","realEvent","handlers","EventBindings","klass","init","_target","_event","_bindings","options","bindings","binding","push","self","_listener","domEvt","isDefined","concat","match","isImmediatePropagationStopped","closest","currentTarget","liveFired","remove","result","l","related","relatedTarget","contains","console","warn","matcherFor","RegExp","replace","matcher","filter","removing","length","removeEventListener","EventsHandler","_handler","specialEvent","bindingEvent","bindType","bindEventName","listener","id","delete","create","special"],"mappings":"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","file":"../eventer.js","sourcesContent":["define([\n    \"./skylark\",\n    \"./langx\",\n    \"./browser\",\n    \"./finder\",\n    \"./noder\",\n    \"./datax\"\n], function(skylark, langx, browser, finder, noder, datax) {\n    var mixin = langx.mixin,\n        each = langx.each,\n        slice = Array.prototype.slice,\n        uid = langx.uid,\n        ignoreProperties = /^([A-Z]|returnValue$|layer[XY]$)/,\n        eventMethods = {\n            preventDefault: \"isDefaultPrevented\",\n            stopImmediatePropagation: \"isImmediatePropagationStopped\",\n            stopPropagation: \"isPropagationStopped\"\n        },\n        readyRE = /complete|loaded|interactive/;\n\n    function compatible(event, source) {\n        if (source || !event.isDefaultPrevented) {\n            if (!source) {\n                source = event;\n            }\n\n            langx.each(eventMethods, function(name, predicate) {\n                var sourceMethod = source[name];\n                event[name] = function() {\n                    this[predicate] = langx.returnTrue;\n                    return sourceMethod && sourceMethod.apply(source, arguments);\n                }\n                event[predicate] = langx.returnFalse;\n            });\n        }\n        return event;\n    }\n\n    function parse(event) {\n        var segs = (\"\" + event).split(\".\");\n        return {\n            type: segs[0],\n            ns: segs.slice(1).sort().join(\" \")\n        };\n    }\n\n    //create a custom dom event\n    var createEvent = (function() {\n        var EventCtors = [\n                window[\"CustomEvent\"], // 0 default\n                window[\"CompositionEvent\"], // 1\n                window[\"DragEvent\"], // 2\n                window[\"Event\"], // 3\n                window[\"FocusEvent\"], // 4\n                window[\"KeyboardEvent\"], // 5\n                window[\"MessageEvent\"], // 6\n                window[\"MouseEvent\"], // 7\n                window[\"MouseScrollEvent\"], // 8\n                window[\"MouseWheelEvent\"], // 9\n                window[\"MutationEvent\"], // 10\n                window[\"ProgressEvent\"], // 11\n                window[\"TextEvent\"], // 12\n                window[\"TouchEvent\"], // 13\n                window[\"UIEvent\"], // 14\n                window[\"WheelEvent\"] // 15\n            ],\n            NativeEvents = {\n                \"compositionstart\": 1, // CompositionEvent\n                \"compositionend\": 1, // CompositionEvent\n                \"compositionupdate\": 1, // CompositionEvent\n\n                \"beforecopy\": 2, // DragEvent\n                \"beforecut\": 2, // DragEvent\n                \"beforepaste\": 2, // DragEvent\n                \"copy\": 2, // DragEvent\n                \"cut\": 2, // DragEvent\n                \"paste\": 2, // DragEvent\n\n                \"drag\": 2, // DragEvent\n                \"dragend\": 2, // DragEvent\n                \"dragenter\": 2, // DragEvent\n                \"dragexit\": 2, // DragEvent\n                \"dragleave\": 2, // DragEvent\n                \"dragover\": 2, // DragEvent\n                \"dragstart\": 2, // DragEvent\n                \"drop\": 2, // DragEvent\n\n                \"abort\": 3, // Event\n                \"change\": 3, // Event\n                \"error\": 3, // Event\n                \"selectionchange\": 3, // Event\n                \"submit\": 3, // Event\n                \"reset\": 3, // Event\n\n                \"focus\": 4, // FocusEvent\n                \"blur\": 4, // FocusEvent\n                \"focusin\": 4, // FocusEvent\n                \"focusout\": 4, // FocusEvent\n\n                \"keydown\": 5, // KeyboardEvent\n                \"keypress\": 5, // KeyboardEvent\n                \"keyup\": 5, // KeyboardEvent\n\n                \"message\": 6, // MessageEvent\n\n                \"click\": 7, // MouseEvent\n                \"contextmenu\": 7, // MouseEvent\n                \"dblclick\": 7, // MouseEvent\n                \"mousedown\": 7, // MouseEvent\n                \"mouseup\": 7, // MouseEvent\n                \"mousemove\": 7, // MouseEvent\n                \"mouseover\": 7, // MouseEvent\n                \"mouseout\": 7, // MouseEvent\n                \"mouseenter\": 7, // MouseEvent\n                \"mouseleave\": 7, // MouseEvent\n\n\n                \"textInput\": 12, // TextEvent\n\n                \"touchstart\": 13, // TouchEvent\n                \"touchmove\": 13, // TouchEvent\n                \"touchend\": 13, // TouchEvent\n\n                \"load\": 14, // UIEvent\n                \"resize\": 14, // UIEvent\n                \"select\": 14, // UIEvent\n                \"scroll\": 14, // UIEvent\n                \"unload\": 14, // UIEvent,\n\n                \"wheel\": 15 // WheelEvent\n            }\n        ;\n\n        function getEventCtor(type) {\n            var idx = NativeEvents[type];\n            if (!idx) {\n                idx = 0;\n            }\n            return EventCtors[idx];\n        }\n\n        return function(type, props) {\n            //create a custom dom event\n\n            if (langx.isString(type)) {\n                props = props || {};\n            } else {\n                props = type;\n                type = props.type;\n            }\n            var parsed = parse(type);\n            type = parsed.type;\n\n            props = langx.mixin({\n                bubbles: true,\n                cancelable: true\n            }, props);\n\n            if (parsed.ns) {\n                props.namespace = parsed.ns;\n            }\n\n            var ctor = getEventCtor(type),\n                e = new ctor(type, props);\n\n            langx.safeMixin(e, props);\n\n            return compatible(e);\n        };\n    })();\n\n    function createProxy(event) {\n        var key,\n            proxy = {\n                originalEvent: event\n            };\n        for (key in event) {\n            if (key !== \"keyIdentifier\" && !ignoreProperties.test(key) && event[key] !== undefined) {\n                proxy[key] = event[key];\n            }\n        }\n        return compatible(proxy, event);\n    }\n\n    var\n        specialEvents = {},\n        focusinSupported = \"onfocusin\" in window,\n        focus = { focus: \"focusin\", blur: \"focusout\" },\n        hover = { mouseenter: \"mouseover\", mouseleave: \"mouseout\" },\n        realEvent = function(type) {\n            return hover[type] || (focusinSupported && focus[type]) || type;\n        },\n        handlers = {},\n        EventBindings = langx.klass({\n            init: function(target, event) {\n                this._target = target;\n                this._event = event;\n                this._bindings = [];\n            },\n\n            add: function(fn, options) {\n                var bindings = this._bindings,\n                    binding = {\n                        fn: fn,\n                        options: langx.mixin({}, options)\n                    };\n\n                bindings.push(binding);\n\n                var self = this;\n                if (!self._listener) {\n                    self._listener = function(domEvt) {\n                        var elm = this,\n                            e = createProxy(domEvt),\n                            args = domEvt._args,\n                            bindings = self._bindings,\n                            ns = e.namespace;\n\n                        if (langx.isDefined(args)) {\n                            args = [e].concat(args);\n                        } else {\n                            args = [e];\n                        }\n\n                        langx.each(bindings,function(idx,binding) {\n                            var match = elm;\n                            if (e.isImmediatePropagationStopped && e.isImmediatePropagationStopped()) {\n                                return false;\n                            }\n                            var fn = binding.fn,\n                                options = binding.options || {},\n                                selector = options.selector,\n                                one = options.one,\n                                data = options.data;\n\n                            if (ns && ns != options.ns) {\n                                return ;\n                            }\n                            if (selector) {\n                                match = finder.closest(e.target, selector);\n                                if (match && match !== elm) {\n                                    langx.mixin(e, {\n                                        currentTarget: match,\n                                        liveFired: elm\n                                    });\n                                } else {\n                                    return ;\n                                }\n                            }\n\n                            if (langx.isDefined(data)) {\n                                e.data = data;\n                            }\n\n                            if (one) {\n                                self.remove(fn, options);\n                            }\n\n                            var result = fn.apply(match, args);\n\n                            if (result === false) {\n                                e.preventDefault();\n                                e.stopPropagation();\n                            }\n                        });;\n                    };\n\n                    var event = self._event;\n                    if (event in hover) {\n                        var l = self._listener;\n                        self._listener = function(e) {\n                            var related = e.relatedTarget;\n                            if (!related || (related !== this && !noder.contains(this, related))) {\n                                return l.apply(this, arguments);\n                            }\n                        }\n                    }\n\n                    if (self._target.addEventListener) {\n                        self._target.addEventListener(realEvent(event), self._listener, false);\n                    } else {\n                        console.warn(\"invalid eventer object\", self._target);\n                    }\n                }\n\n            },\n            remove: function(fn, options) {\n                options = langx.mixin({}, options);\n\n                function matcherFor(ns) {\n                    return new RegExp(\"(?:^| )\" + ns.replace(\" \", \" .* ?\") + \"(?: |$)\");\n                }\n                var matcher;\n                if (options.ns) {\n                    matcher = matcherFor(options.ns);\n                }\n\n                this._bindings = this._bindings.filter(function(binding) {\n                    var removing = (!fn || fn === binding.fn) &&\n                        (!matcher || matcher.test(binding.options.ns)) &&\n                        (!options.selector || options.selector == binding.options.selector);\n\n                    return !removing;\n                });\n                if (this._bindings.length == 0) {\n                    if (this._target.removeEventListener) {\n                        this._target.removeEventListener(realEvent(this._event), this._listener, false);\n                    }\n                    this._listener = null;\n                }\n            }\n        }),\n        EventsHandler = langx.klass({\n            init: function(elm) {\n                this._target = elm;\n                this._handler = {};\n            },\n\n            // add a event listener\n            // selector Optional\n            register: function(event, callback, options) {\n                // Seperate the event from the namespace\n                var parsed = parse(event),\n                    event = parsed.type,\n                    specialEvent = specialEvents[event],\n                    bindingEvent = specialEvent && (specialEvent.bindType || specialEvent.bindEventName);\n\n                var events = this._handler;\n\n                // Check if there is already a handler for this event\n                if (events[event] === undefined) {\n                    events[event] = new EventBindings(this._target, bindingEvent || event);\n                }\n\n                // Register the new callback function\n                events[event].add(callback, langx.mixin({\n                    ns: parsed.ns\n                }, options)); // options:{selector:xxx}\n            },\n\n            // remove a event listener\n            unregister: function(event, fn, options) {\n                // Check for parameter validtiy\n                var events = this._handler,\n                    parsed = parse(event);\n                event = parsed.type;\n\n                var listener = events[event];\n\n                if (listener) {\n                    listener.remove(fn, langx.mixin({\n                        ns: parsed.ns\n                    }, options));\n                }\n            }\n        }),\n\n        findHandler = function(elm) {\n            var id = uid(elm),\n                handler = handlers[id];\n            if (!handler) {\n                handler = handlers[id] = new EventsHandler(elm);\n            }\n            return handler;\n        };\n\n    function off(elm, events, selector, callback) {\n        var $this = this\n        if (langx.isPlainObject(events)) {\n            langx.each(events, function(type, fn) {\n                off(elm, type, selector, fn);\n            })\n            return $this;\n        }\n\n        if (!langx.isString(selector) && !langx.isFunction(callback) && callback !== false) {\n            callback = selector;\n            selector = undefined;\n        }\n\n        if (callback === false) {\n            callback = langx.returnFalse;\n        }\n\n        if (typeof events == \"string\") {\n            if (events.indexOf(\",\") > -1) {\n                events = events.split(\",\");\n            } else {\n                events = events.split(/\\s/);\n            }\n        }\n\n        var handler = findHandler(elm);\n\n        if (events) events.forEach(function(event) {\n\n            handler.unregister(event, callback, {\n                selector: selector,\n            });\n        });\n        return this;\n    }\n\n    function on(elm, events, selector, data, callback, one) {\n\n        var autoRemove, delegator;\n        if (langx.isPlainObject(events)) {\n            langx.each(events, function(type, fn) {\n                on(elm, type, selector, data, fn, one);\n            });\n            return this;\n        }\n\n        if (!langx.isString(selector) && !langx.isFunction(callback)) {\n            callback = data;\n            data = selector;\n            selector = undefined;\n        }\n\n        if (langx.isFunction(data)) {\n            callback = data;\n            data = undefined;\n        }\n\n        if (callback === false) {\n            callback = langx.returnFalse;\n        }\n\n        if (typeof events == \"string\") {\n            if (events.indexOf(\",\") > -1) {\n                events = events.split(\",\");\n            } else {\n                events = events.split(/\\s/);\n            }\n        }\n\n        var handler = findHandler(elm);\n\n        events.forEach(function(event) {\n            if (event == \"ready\") {\n                return ready(callback);\n            }\n            handler.register(event, callback, {\n                data: data,\n                selector: selector,\n                one: !!one\n            });\n        });\n        return this;\n    }\n\n    function one(elm, events, selector, data, callback) {\n        on(elm, events, selector, data, callback, 1);\n\n        return this;\n    }\n\n    function stop(event) {\n        if (window.document.all) {\n            event.keyCode = 0;\n        }\n        if (event.preventDefault) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n        return this;\n    }\n\n    function trigger(evented, type, args) {\n        var e;\n        if (type instanceof Event) {\n            e = type;\n        } else {\n            e = createEvent(type, args);\n        }\n        e._args = args;\n\n        (evented.dispatchEvent || evented.trigger).call(evented, e);\n\n        return this;\n    }\n\n    function ready(callback) {\n        // need to check if document.body exists for IE as that browser reports\n        // document ready when it hasn't yet created the body elm\n        if (readyRE.test(document.readyState) && document.body) {\n            callback()\n        } else {\n            document.addEventListener('DOMContentLoaded', callback, false);\n        }\n\n        return this;\n    }\n\n    var keyCodeLookup = {\n        \"delete\": 46\n    };\n    //example:\n    //shortcuts(elm).add(\"CTRL+ALT+SHIFT+X\",function(){console.log(\"test!\")});\n    function shortcuts(elm) {\n\n        var registry = datax.data(elm, \"shortcuts\");\n        if (!registry) {\n            registry = {};\n            datax.data(elm, \"shortcuts\", registry);\n            var run = function(shortcut, event) {\n                var n = event.metaKey || event.ctrlKey;\n                if (shortcut.ctrl == n && shortcut.alt == event.altKey && shortcut.shift == event.shiftKey) {\n                    if (event.keyCode == shortcut.keyCode || event.charCode && event.charCode == shortcut.charCode) {\n                        event.preventDefault();\n                        if (\"keydown\" == event.type) {\n                            shortcut.fn(event);\n                        }\n                        return true;\n                    }\n                }\n            };\n            on(elm, \"keyup keypress keydown\", function(event) {\n                if (!(/INPUT|TEXTAREA/.test(event.target.nodeName))) {\n                    for (var key in registry) {\n                        run(registry[key], event);\n                    }\n                }\n            });\n\n        }\n\n        return {\n            add: function(pattern, fn) {\n                var shortcutKeys;\n                if (pattern.indexOf(\",\") > -1) {\n                    shortcutKeys = pattern.toLowerCase().split(\",\");\n                } else {\n                    shortcutKeys = pattern.toLowerCase().split(\" \");\n                }\n                shortcutKeys.forEach(function(shortcutKey) {\n                    var setting = {\n                        fn: fn,\n                        alt: false,\n                        ctrl: false,\n                        shift: false\n                    };\n                    shortcutKey.split(\"+\").forEach(function(key) {\n                        switch (key) {\n                            case \"alt\":\n                            case \"ctrl\":\n                            case \"shift\":\n                                setting[key] = true;\n                                break;\n                            default:\n                                setting.charCode = key.charCodeAt(0);\n                                setting.keyCode = keyCodeLookup[key] || key.toUpperCase().charCodeAt(0);\n                        }\n                    });\n                    var regKey = (setting.ctrl ? \"ctrl\" : \"\") + \",\" + (setting.alt ? \"alt\" : \"\") + \",\" + (setting.shift ? \"shift\" : \"\") + \",\" + setting.keyCode;\n                    registry[regKey] = setting;\n                })\n            }\n\n        };\n\n    }\n\n    function eventer() {\n        return eventer;\n    }\n\n    langx.mixin(eventer, {\n        create: createEvent,\n\n        off: off,\n\n        on: on,\n\n        one: one,\n\n        proxy: createProxy,\n\n        ready: ready,\n\n        shortcuts: shortcuts,\n\n        special : specialEvents,\n\n        stop: stop,\n\n        trigger: trigger\n\n    });\n\n    return skylark.eventer = eventer;\n});\n"]}