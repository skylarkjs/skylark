{"version":3,"sources":["datax.js"],"names":["define","skylark","langx","finder","setAttribute","elm","name","value","removeAttribute","attr","undefined","this","attrName","hasAttribute","getAttribute","_attributeData","store","each","attributes","i","indexOf","camelCase","replace","deserializeValue","_store","confirm","_getData","camelName","capitalRE","toLowerCase","_setData","data","dataAttrName","removeData","names","isString","split","forEach","pluck","nodes","property","map","call","prop","propMap","removeAttr","text","txt","textContent","val","multiple","selectedOptions","filter","find","option","selected","datax","Array","prototype","tabindex","readonly","for","class","maxlength","cellspacing","cellpadding","rowspan","colspan","usemap","frameborder","contenteditable","mixin"],"mappings":"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","file":"../datax.js","sourcesContent":["define([\n    \"./skylark\",\n    \"./langx\",\n    \"./finder\"\n], function(skylark, langx, finder) {\n    var map = Array.prototype.map,\n        filter = Array.prototype.filter,\n        camelCase = langx.camelCase,\n        deserializeValue = langx.deserializeValue,\n\n        capitalRE = /([A-Z])/g,\n        propMap = {\n            'tabindex': 'tabIndex',\n            'readonly': 'readOnly',\n            'for': 'htmlFor',\n            'class': 'className',\n            'maxlength': 'maxLength',\n            'cellspacing': 'cellSpacing',\n            'cellpadding': 'cellPadding',\n            'rowspan': 'rowSpan',\n            'colspan': 'colSpan',\n            'usemap': 'useMap',\n            'frameborder': 'frameBorder',\n            'contenteditable': 'contentEditable'\n        };\n\n    function setAttribute(elm, name, value) {\n        if (value == null) {\n            elm.removeAttribute(name);\n        } else {\n            elm.setAttribute(name, value);\n        }\n    }\n\n    function attr(elm, name, value) {\n        if (value === undefined) {\n            if (typeof name === \"object\") {\n                for (var attrName in name) {\n                    attr(elm, attrName, name[attrName]);\n                }\n                return this;\n            } else {\n                if (elm.hasAttribute(name)) {\n                    return elm.getAttribute(name);\n                }\n            }\n        } else {\n            elm.setAttribute(name, value);\n            return this;\n        }\n    }\n\n    // Read all \"data-*\" attributes from a node\n    function _attributeData(elm) {\n        var store = {}\n        langx.each(elm.attributes || [], function(i, attr) {\n            if (attr.name.indexOf('data-') == 0) {\n                store[camelCase(attr.name.replace('data-', ''))] = deserializeValue(attr.value);\n            }\n        })\n        return store;\n    }\n\n    function _store(elm, confirm) {\n        var store = elm[\"_$_store\"];\n        if (!store && confirm) {\n            store = elm[\"_$_store\"] = _attributeData(elm);\n        }\n        return store;\n    }\n\n    function _getData(elm, name) {\n        if (name === undefined) {\n            return _store(elm, true);\n        } else {\n            var store = _store(elm);\n            if (store) {\n                if (name in store) {\n                    return store[name];\n                }\n                var camelName = camelCase(name);\n                if (camelName in store) {\n                    return store[camelName];\n                }\n            }\n            var attrName = 'data-' + name.replace(capitalRE, \"-$1\").toLowerCase()\n            return attr(elm, attrName);\n        }\n\n    }\n\n    function _setData(elm, name, value) {\n        var store = _store(elm, true);\n        store[camelCase(name)] = value;\n    }\n\n\n    function data(elm, name, value) {\n\n        if (value === undefined) {\n            if (typeof name === \"object\") {\n                for (var dataAttrName in name) {\n                    _setData(elm, dataAttrName, name[dataAttrName]);\n                }\n                return this;\n            } else {\n                return _getData(elm, name);\n            }\n        } else {\n            _setData(elm, name, value);\n            return this;\n        }\n    }\n\n    function removeData(elm, names) {\n        if (langx.isString(names)) {\n            names = names.split(/\\s+/);\n        }\n        var store = _store(elm, true);\n        names.forEach(function(name) {\n            delete store[name];\n        });\n        return this;\n    }\n\n    function pluck(nodes, property) {\n        return map.call(nodes, function(elm) {\n            return elm[property];\n        });\n    }\n\n    function prop(elm, name, value) {\n        name = propMap[name] || name;\n        if (value === undefined) {\n            return elm[name];\n        } else {\n            elm[name] = value;\n            return this;\n        }\n    }\n\n    function removeAttr(elm, name) {\n        name.split(' ').forEach(function(attr) {\n            setAttribute(elm, attr);\n        });\n        return this;\n    }\n\n    function text(elm, txt) {\n        if (txt === undefined) {\n            return elm.textContent;\n        } else {\n            elm.textContent = txt == null ? '' : '' + txt;\n            return this;\n        }\n    }\n\n    function val(elm, value) {\n        if (value === undefined) {\n            if (elm.multiple) {\n                // select multiple values\n                var selectedOptions = filter.call(finder.find(elm, \"option\"), (function(option) {\n                    return option.selected;\n                }));\n                return pluck(selectedOptions, \"value\");\n            } else {\n                return elm.value;\n            }\n        } else {\n            elm.value = value;\n            return this;\n        }\n    }\n\n    function datax() {\n        return datax;\n    }\n\n    langx.mixin(datax, {\n        attr: attr,\n\n        data: data,\n\n        pluck: pluck,\n\n        prop: prop,\n\n        removeAttr: removeAttr,\n\n        removeData: removeData,\n\n        text: text,\n\n        val: val\n    });\n\n    return skylark.datax = datax;\n});\n"]}