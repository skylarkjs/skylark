{"version":3,"sources":["_devices/usermedia.js"],"names":["define","langx","usermedia","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","Deferred","localStream","mixin","isSupported","start","video","audio","d","stream","src","window","URL","createObjectURL","localMediaStream","onloadedmetadata","e","resolve","err","reject","promise","stop"],"mappings":";;;;;;;AAAAA,QACI,YACD,SAASC,GASR,QAASC,KACL,MAAOA,GATXC,UAAUC,aAAeD,UAAUC,cACZD,UAAUE,oBACVF,UAAUG,iBACVH,UAAUI,cAEjC,IAAIC,GAAWP,EAAMO,SACjBC,EAAe,IA4CnB,OAtCAR,GAAMS,MAAMR,GACRS,YAAc,WACV,QAASR,UAAUC,cAGvBQ,MAAQ,SAASC,EAAMC,GAEnB,GAAIC,GAAI,GAAIP,EAmBZ,OAlBAL,WAAUC,cACLS,OAAO,EAAKC,OAAO,GAEpB,SAASE,GACLP,EAAcO,EACdH,EAAMI,IAAMC,OAAOC,IAAIC,gBAAgBC,kBACvCR,EAAMS,iBAAmB,SAASC,KAGlCR,EAAES,WAIN,SAASC,GACPV,EAAEW,OAAOD,KAIRV,EAAEY,SAGbC,KAAO,WACCnB,IACAA,EAAYmB,OACZnB,EAAc,SAMlBP","file":"../../_devices/usermedia.js","sourcesContent":["define([\r\n    \"../langx\"\r\n], function(langx) {\r\n    navigator.getUserMedia = navigator.getUserMedia\r\n                        || navigator.webkitGetUserMedia\r\n                        || navigator.mozGetUserMedia\r\n                        || navigator.msGetUserMedia;\r\n   \r\n    var Deferred = langx.Deferred,\r\n        localStream  = null;\r\n\r\n    function usermedia() {\r\n        return usermedia;\r\n    }\r\n\r\n    langx.mixin(usermedia, {\r\n        isSupported : function() {\r\n            return !!navigator.getUserMedia;\r\n        },\r\n\r\n        start : function(video,audio) {\r\n\r\n            var d = new Deferred();\r\n            navigator.getUserMedia (\r\n                {video: true,audio: true},\r\n                // successCallback\r\n                function(stream) {\r\n                    localStream = stream;\r\n                    video.src = window.URL.createObjectURL(localMediaStream);\r\n                    video.onloadedmetadata = function(e) {\r\n                         // Do something with the video here.\r\n                    };\r\n                    d.resolve();\r\n                },\r\n\r\n                // errorCallback\r\n                function(err) {\r\n                  d.reject(err);\r\n                }\r\n            );\r\n\r\n            return d.promise;\r\n        },\r\n\r\n        stop : function() {\r\n            if (localStream) {\r\n                localStream.stop();\r\n                localStream = null; \r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    return  usermedia;\r\n});\r\n"]}