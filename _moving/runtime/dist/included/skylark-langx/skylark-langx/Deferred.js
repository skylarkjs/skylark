/**
 * skylark-langx - A simple JavaScript language extension library, including class support, Evented class, Deferred class and some commonly used tool functions.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./arrays","./funcs","./objects"],function(e,t,r){"use strict";function n(e,t){var r={state:function(){return t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},then:function(e,t,n){return n&&this.progress(n),p(Promise.prototype.then.call(this,e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)},t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)}),r)},progress:function(e){return t[o].push(e),this}};return r.pipe=r.then,p(e,r)}var o=Symbol?Symbol():"__pglisteners",i=Array.prototype.slice,s=t.proxy,c=e.makeArray,u=r.result,p=r.mixin;p(Promise.prototype,{always:function(e){return this.then(e,e),this},done:function(e){return this.then(e),this},fail:function(e){return this["catch"](e),this}});var h=function(){var e=this,t=this.promise=new Promise(function(t,r){e._resolve=t,e._reject=r});n(t,e),this[o]=[]};return h.prototype.resolve=function(e){var t=i.call(arguments);return this.resolveWith(null,t)},h.prototype.resolveWith=function(e,t){return t=t?c(t):[],t.__ctx__=e,this._resolve(t),this._resolved=!0,this},h.prototype.progress=function(e){try{return this[o].forEach(function(t){return t(e)})}catch(t){this.reject(t)}return this},h.prototype.reject=function(e){var t=i.call(arguments);return this.rejectWith(null,t)},h.prototype.rejectWith=function(e,t){return t=t?c(t):[],t.__ctx__=e,this._reject(t),this._rejected=!0,this},h.prototype.isResolved=function(){return!!this._resolved},h.prototype.isRejected=function(){return!!this._rejected},h.prototype.then=function(e,t,r){var n=u(this,"promise");return n.then(e,t,r)},h.prototype.done=h.prototype.then,h.all=function(e){return n(Promise.all(e))},h.first=function(e){return n(Promise.race(e))},h.when=function(e,t,r,n){var o=e&&"function"==typeof e.then,i=o&&e instanceof Promise;if(!o)return arguments.length>1?t?t(e):e:(new h).resolve(e);if(!i){var c=new h(e.cancel);e.then(s(c.resolve,c),s(c.reject,c),c.progress),e=c.promise}return t||r||n?e.then(t,r,n):e},h.reject=function(e){var t=new h;return t.reject(e),t.promise},h.resolve=function(e){var t=new h;return t.resolve.apply(t,arguments),t.promise},h.immediate=h.resolve,h});
//# sourceMappingURL=sourcemaps/Deferred.js.map
