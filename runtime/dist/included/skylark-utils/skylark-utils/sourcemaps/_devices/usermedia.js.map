{"version":3,"sources":["_devices/usermedia.js"],"names":["define","langx","usermedia","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","Deferred","localStream","mixin","isSupported","start","video","audio","d","stream","src","window","URL","createObjectURL","localMediaStream","onloadedmetadata","e","resolve","err","reject","promise","stop"],"mappings":";;;;;;;AAAAA,QACI,YACD,SAASC,GASR,QAASC,KACL,MAAOA,GATXC,UAAUC,aAAeD,UAAUC,cACZD,UAAUE,oBACVF,UAAUG,iBACVH,UAAUI,cAEjC,IAAIC,GAAWP,EAAMO,SACjBC,EAAe,IA4CnB,OAtCAR,GAAMS,MAAMR,GACRS,YAAc,WACV,QAASR,UAAUC,cAGvBQ,MAAQ,SAASC,EAAMC,GAEnB,GAAIC,GAAI,GAAIP,EAmBZ,OAlBAL,WAAUC,cACLS,OAAO,EAAKC,OAAO,GAEpB,SAASE,GACLP,EAAcO,EACdH,EAAMI,IAAMC,OAAOC,IAAIC,gBAAgBC,kBACvCR,EAAMS,iBAAmB,SAASC,KAGlCR,EAAES,WAIN,SAASC,GACPV,EAAEW,OAAOD,KAIRV,EAAEY,SAGbC,KAAO,WACCnB,IACAA,EAAYmB,OACZnB,EAAc,SAMlBP","file":"../../_devices/usermedia.js","sourcesContent":["define([\n    \"../langx\"\n], function(langx) {\n    navigator.getUserMedia = navigator.getUserMedia\n                        || navigator.webkitGetUserMedia\n                        || navigator.mozGetUserMedia\n                        || navigator.msGetUserMedia;\n   \n    var Deferred = langx.Deferred,\n        localStream  = null;\n\n    function usermedia() {\n        return usermedia;\n    }\n\n    langx.mixin(usermedia, {\n        isSupported : function() {\n            return !!navigator.getUserMedia;\n        },\n\n        start : function(video,audio) {\n\n            var d = new Deferred();\n            navigator.getUserMedia (\n                {video: true,audio: true},\n                // successCallback\n                function(stream) {\n                    localStream = stream;\n                    video.src = window.URL.createObjectURL(localMediaStream);\n                    video.onloadedmetadata = function(e) {\n                         // Do something with the video here.\n                    };\n                    d.resolve();\n                },\n\n                // errorCallback\n                function(err) {\n                  d.reject(err);\n                }\n            );\n\n            return d.promise;\n        },\n\n        stop : function() {\n            if (localStream) {\n                localStream.stop();\n                localStream = null; \n            }\n        }\n    });\n\n\n    return  usermedia;\n});\n"]}